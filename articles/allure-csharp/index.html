<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Ilya Murzinov: Introducing Allure in C# project</title>
        <link rel="icon" type="image/png" href="../../images/favicon.png" />
        <link rel="icon" type="image/png" href="../../images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="../../images/favicon-16x16.png" sizes="16x16" />
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../../css/syntax.css" />
        <link rel="stylesheet" type="text/css" href="../../css/font-awesome.min.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../../">Ilya Murzinov</a>
            </div>
            <div id="navigation">
                <a href="https://github.com/ilya-murzinov"><i class="fa fa-github fa-1x"></i></a>
                <a href="https://github.com/ilya-murzinov/ilya-murzinov.github.io/tree/hakyll"><i class="fa fa-code fa-1x"></i></a>
                <a href="https://twitter.com/ilyamurzinov"><i class="fa fa-twitter fa-1x"></i>
                <a href="https://www.facebook.com/Murzinov.Ilya"><i class="fa fa-facebook fa-1x"></i>
                <a href="https://www.instagram.com/ilyamurzinov/"><i class="fa fa-instagram fa-1x"></i>
                <a href="../../talks/">Talks</a>
                <a href="../../about/">About</a>
            </div>
        </div>

        <div id="content">
            <h1>Introducing Allure in C# project</h1>

<div class="info">
    Posted on February 25, 2015
    
</div>

<h2 id="background">Background</h2>
<!-- TEASER START -->
<p>About a year ago I worked as a QA automation engineer and, of course, had to deal with lots of test reports. In our company we had both unit- and UI-tests and used MS Test + Team Foundation Server + Microsoft Test Manager 2012 to run our automated tests, collect and view all the reports. But this solution had too many disadvantages for me:</p>
<ul>
<li>It’s <strong>expensive</strong> (meaning not free :) )</li>
<li>Reports are hard to read and analyse</li>
<li>There is no (easy) way to attach anything to test report</li>
<li>I personally liked NUnit more than MS Test.</li>
</ul>
<!-- TEASER STOP -->
<p>And then I discovered <a href="http://allure.qatools.ru">Allure Framework</a> - open-source tool which was developed by Yandex test team and it provides really great reports. You can browse their site, or watch <a href="http://teamcity.qatools.ru/repository/download/allure_core_master_release/lastSuccessful/index.html?guest=1#/home">sample report</a> to convince yourself that it’s a very good. Allure consists of 2 important parts - adapter and generator. Adapter produces XML files in specific format for generator to generate the final report.</p>
<p>Unfortunately, by the time I found Allure, there was no way to use it in C# project, because there was no adapter for C#. So if I wanted to use Allure, I had to develop a little addon for testing framework (MS Test or NUnit) which would generate XML report.</p>
<p>But that was not a problem for me, I’m an open-source guy, so I quickly decided to develop adapter myself. Long story short, this is the result: <a href="https://github.com/allure-framework/allure-csharp-commons">core library</a> for .NET and <a href="https://github.com/allure-framework/allure-nunit">adapter</a> for NUnit 2. Core library is reusable which makes possible to develop adapters for any .NET testing framework. For example, <a href="https://github.com/someuser77">@someuser77</a> has developed <a href="https://github.com/allure-framework/allure-mstest-adapter">adapter</a> for MS Test.</p>
<p><strong>Disclaimer:</strong> although core library (allure-csharp-commons) is well developed and tested, adapter itself (allure-nunit) may contain some bugs. In case of any troubles, you are welcome to raise an issue in <a href="https://github.com/allure-framework/allure-nunit/issues">bug tracker</a>. Pull-requests are of course also welcomed.</p>
<p>Ok, so we are good to go.</p>
<h2 id="getting-work-done">Getting work done</h2>
<p>End-to-end configuration is pretty tricky, but it can be simplified in the future by using plugins for TeamCity or Jenkins. The result will be *.bat-script you can use to run tests and generate report as a build step in you build server. I will describe this process for NUnit because I was personally using it. But it should be pretty much the same for MS Test.</p>
<p>So what exactly do we need?</p>
<ol style="list-style-type: decimal">
<li>NUnit 2.6.3</li>
<li><a href="https://github.com/allure-framework/allure-nunit/releases">Latest release</a> of allure-nunit</li>
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JRE</a> for allure-cli</li>
<li><a href="https://github.com/allure-framework/allure-cli/releases">Latest release</a> of allure-cli</li>
<li>Web-server, for example <a href="http://nginx.org/">Nginx</a></li>
<li>Built *.dll assemblies with tests</li>
</ol>
<p>First of all, we need to install NUnit, allure-cli, JRE, Nginx and set environmental variables, for example (replace these values with yours):</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">set</span> <span class="va">ASSEMBLIES_DIR=</span>C:\<span class="ex">project</span>\bin\debug
<span class="kw">set</span> <span class="ex">NUNIT_HOME</span> = C:\NUnit-2.6.3
<span class="kw">set</span> <span class="ex">ALLURE_CLI_HOME</span> = C:\allure-cli
<span class="kw">set</span> <span class="ex">JAVA_HOME</span> = C:\Program Files\Java\jre-1.7.0_75
<span class="kw">set</span> <span class="va">NGINX_HOME=</span>C:\<span class="ex">nginx-1.7.0</span></code></pre></div>
<p>Next, we need to install nunit-adapter and configure it. Here are the steps to do it:</p>
<ol style="list-style-type: decimal">
<li>Unpack allure-nunit binaries to %NUNIT_HOME%</li>
<li>Addin will NOT be visible in Tools -&gt; Addins.. because it’s built against .NET 4.0</li>
<li>In %NUNIT_HOME%.xml specify absolute path to any folder (this folder will be created automatically) where XML files will be generated (for example &lt;results-path&gt;C:-results&lt;/results-path&gt;)</li>
<li>You can also specify in configuration whether you want to take screenshots after failed tests and whether you want to have test output to be written to attachments</li>
</ol>
<p>After that we need to add new environmental variable OUTPUT_FOLDER pointing to the folder we specified in adapter’s config.xml:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">set</span> <span class="va">OUTPUT_DIR=</span>C:\<span class="ex">test-results</span>\AllureResults</code></pre></div>
<p>After we set all variables comes the easy part - running tests and generating report. I’ll just provide the resulting *.bat-script, it’s self-explanatory:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">set</span> <span class="va">ASSEMBLIES_DIR=</span>C:\<span class="ex">project</span>\bin\debug
<span class="kw">set</span> <span class="va">NUNIT_HOME=</span>C:\<span class="ex">NUnit-2.6.3</span>
<span class="kw">set</span> <span class="va">ALLURE_CLI_HOME=</span>C:\<span class="ex">allure-cli</span>\allure-cli.jar
<span class="kw">set</span> <span class="va">JAVA_HOME=</span>C:\<span class="ex">Program</span> Files\Java\jre-1.7.0_75
<span class="kw">set</span> <span class="va">OUTPUT_DIR=</span>C:\<span class="ex">test-results</span>\AllureResults
<span class="kw">set</span> <span class="va">NGINX_HOME=</span>C:\<span class="ex">nginx-1.7.0</span>

<span class="ex">%NUNIT_HOME%</span>\bin\nunit-console.exe %ASSEMBLIES_DIR%\YourAssembly.dll /framework=net-4.0
<span class="ex">%JAVA_HOME%</span>\bin\java -jar %ALLURE_CLI_HOME%\allure-cli.jar generate -v 1.4.0 %OUTPUT_DIR% -o %NGINX_HOME%\html\</code></pre></div>
<p>You can run as much *.dll’s as you want or create an *.nuproj project containing all assemblies.</p>
<p>Now we need to start Nginx and thats all! If you’ve done it right, you will see the report at <a href="http://localhost:8080" class="uri">http://localhost:8080</a> (depends on Nginx configuration).</p>
<p>Note that this is only the basic configuration and it can of course be extended/modified.</p>
<h2 id="problems">Problems</h2>
<p>There is one <a href="https://github.com/allure-framework/allure-csharp-commons/issues/3">big issue</a> with allure-csharp-commons, specifically, handling some custom attributes like Attachment, Step. We even have a <a href="https://github.com/allure-framework/allure-csharp-commons/pull/15">pull-request</a> for this issue, but it’s quite complicated and I personally have no time to dig into it.</p>
<p>If you have any questions, you are welcome to ask it in comments.</p>

<div id="disqus_thread"></div>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ilyamurzinovgithubio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="../../web/20160303120853/http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="../../web/20160303120853/http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        <div id="footer">
            Powered by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
    <!-- Asynchronous Google Analytics snippet -->
    <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
         (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-60047092-1', 'auto');
     ga('send', 'pageview');

    </script>

</html>
